{
  "ensemble_config": {
    "method": "average",
    "weights": [
      0.5,
      0.5
    ],
    "full_vit_path": "best_model_full.pt",
    "rnn_vit_path": "best_model_rnn.pt"
  },
  "individual_results": {
    "full_vit": {
      "auc_roc_epidural": 0.8949124270225188,
      "auc_roc_intraparenchymal": 0.9726675680896272,
      "auc_roc_intraventricular": 0.994671201814059,
      "auc_roc_subarachnoid": 0.9268244575936884,
      "auc_roc_subdural": 0.9056829511465604,
      "auc_roc_macro": 0.9389517211332908,
      "auc_roc_micro": 0.9572026585392722,
      "auc_roc_weighted": 0.9457803999210035,
      "auc_roc_healthy": 0.9646927374301677,
      "auc_roc_multiple": 0.7411731843575419,
      "precision_epidural": 0.8,
      "recall_epidural": 0.36363636363636365,
      "f1_epidural": 0.5000000000000001,
      "precision_intraparenchymal": 0.8983050847457628,
      "recall_intraparenchymal": 0.8548387096774194,
      "f1_intraparenchymal": 0.8760330578512397,
      "precision_intraventricular": 0.9111111111111111,
      "recall_intraventricular": 0.8367346938775511,
      "f1_intraventricular": 0.8723404255319148,
      "precision_subarachnoid": 0.7777777777777778,
      "recall_subarachnoid": 0.7,
      "f1_subarachnoid": 0.7368421052631577,
      "precision_subdural": 0.7818181818181819,
      "recall_subdural": 0.7288135593220338,
      "f1_subdural": 0.7543859649122807,
      "precision_macro": 0.8338024310905666,
      "recall_macro": 0.6968046653026736,
      "f1_macro": 0.7479203107117186,
      "precision_micro": 0.8394495412844036,
      "recall_micro": 0.7593360995850622,
      "f1_micro": 0.7973856209150327,
      "precision_weighted": 0.8378975066083865,
      "recall_weighted": 0.7593360995850622,
      "f1_weighted": 0.7936847663213887,
      "accuracy_exact": 0.7030567685589519,
      "accuracy_hamming": 0.9187772925764193,
      "avg_num_positives_pred": 0.9519650655021834,
      "avg_num_positives_true": 1.0524017467248907
    },
    "rnn_vit": {
      "auc_roc_epidural": 0.8527939949958299,
      "auc_roc_intraparenchymal": 0.8825574657137338,
      "auc_roc_intraventricular": 0.9442176870748299,
      "auc_roc_subarachnoid": 0.8265285996055226,
      "auc_roc_subdural": 0.8774675972083749,
      "auc_roc_macro": 0.8767130689196583,
      "auc_roc_micro": 0.8607525795909374,
      "auc_roc_weighted": 0.8785405298651361,
      "auc_roc_healthy": 0.9081564245810055,
      "auc_roc_multiple": 0.7176536312849162,
      "precision_epidural": 0.22727272727272727,
      "recall_epidural": 0.45454545454545453,
      "f1_epidural": 0.30303030303030304,
      "precision_intraparenchymal": 0.7209302325581395,
      "recall_intraparenchymal": 0.5,
      "f1_intraparenchymal": 0.5904761904761905,
      "precision_intraventricular": 0.7872340425531915,
      "recall_intraventricular": 0.7551020408163265,
      "f1_intraventricular": 0.7708333333333333,
      "precision_subarachnoid": 1.0,
      "recall_subarachnoid": 0.016666666666666666,
      "f1_subarachnoid": 0.03278688524590164,
      "precision_subdural": 0.8666666666666667,
      "recall_subdural": 0.22033898305084745,
      "f1_subdural": 0.3513513513513513,
      "precision_macro": 0.720420733810145,
      "recall_macro": 0.389330629015859,
      "f1_macro": 0.40969561268741594,
      "precision_micro": 0.6796875,
      "recall_micro": 0.36099585062240663,
      "f1_micro": 0.47154471544715443,
      "precision_weighted": 0.8170351694483168,
      "recall_weighted": 0.36099585062240663,
      "f1_weighted": 0.4166416320359929,
      "accuracy_exact": 0.4017467248908297,
      "accuracy_hamming": 0.8296943231441047,
      "avg_num_positives_pred": 0.5589519650655022,
      "avg_num_positives_true": 1.0524017467248907
    }
  },
  "ensemble_threshold_independent_metrics": {
    "auc_roc_epidural": 0.9236864053377815,
    "auc_roc_intraparenchymal": 0.9736333784044814,
    "auc_roc_intraventricular": 0.993424036281179,
    "auc_roc_subarachnoid": 0.9347140039447732,
    "auc_roc_subdural": 0.9190428713858425,
    "auc_roc_macro": 0.9489001390708115,
    "auc_roc_micro": 0.9610123746924687,
    "auc_roc_weighted": 0.9523235159585988,
    "auc_roc_healthy": 0.9712849162011173,
    "auc_roc_multiple": 0.7596648044692738,
    "precision_epidural": 0.8,
    "recall_epidural": 0.36363636363636365,
    "f1_epidural": 0.5000000000000001,
    "precision_intraparenchymal": 0.9090909090909091,
    "recall_intraparenchymal": 0.8064516129032258,
    "f1_intraparenchymal": 0.8547008547008547,
    "precision_intraventricular": 0.9166666666666666,
    "recall_intraventricular": 0.8979591836734694,
    "f1_intraventricular": 0.9072164948453607,
    "precision_subarachnoid": 0.9210526315789473,
    "recall_subarachnoid": 0.5833333333333334,
    "f1_subarachnoid": 0.7142857142857143,
    "precision_subdural": 0.8125,
    "recall_subdural": 0.6610169491525424,
    "f1_subdural": 0.7289719626168225,
    "precision_macro": 0.8718620414673046,
    "recall_macro": 0.6624794885397869,
    "f1_macro": 0.7410350052897504,
    "precision_micro": 0.8865979381443299,
    "recall_micro": 0.7136929460580913,
    "f1_micro": 0.7908045977011493,
    "precision_weighted": 0.8849832403528625,
    "recall_weighted": 0.7136929460580913,
    "f1_weighted": 0.7834504144830335,
    "accuracy_exact": 0.6943231441048034,
    "accuracy_hamming": 0.9205240174672489,
    "avg_num_positives_pred": 0.8471615720524017,
    "avg_num_positives_true": 1.0524017467248907
  },
  "ensemble_metrics_default_threshold": {
    "precision_macro_default": 0.8718620414673046,
    "recall_macro_default": 0.6624794885397869,
    "f1_macro_default": 0.7410350052897504,
    "precision_micro_default": 0.8865979381443299,
    "recall_micro_default": 0.7136929460580913,
    "f1_micro_default": 0.7908045977011493,
    "precision_weighted_default": 0.8849832403528625,
    "recall_weighted_default": 0.7136929460580913,
    "f1_weighted_default": 0.7834504144830335,
    "accuracy_exact_default": 0.6943231441048034,
    "accuracy_hamming_default": 0.9205240174672489,
    "precision_epidural_default": 0.8,
    "recall_epidural_default": 0.36363636363636365,
    "f1_epidural_default": 0.5000000000000001,
    "precision_intraparenchymal_default": 0.9090909090909091,
    "recall_intraparenchymal_default": 0.8064516129032258,
    "f1_intraparenchymal_default": 0.8547008547008547,
    "precision_intraventricular_default": 0.9166666666666666,
    "recall_intraventricular_default": 0.8979591836734694,
    "f1_intraventricular_default": 0.9072164948453607,
    "precision_subarachnoid_default": 0.9210526315789473,
    "recall_subarachnoid_default": 0.5833333333333334,
    "f1_subarachnoid_default": 0.7142857142857143,
    "precision_subdural_default": 0.8125,
    "recall_subdural_default": 0.6610169491525424,
    "f1_subdural_default": 0.7289719626168225
  },
  "ensemble_metrics_best_threshold": {
    "precision_macro_best": 0.6869758735764206,
    "recall_macro_best": 0.8476299352187816,
    "f1_macro_best": 0.7577711395786684,
    "precision_micro_best": 0.7052980132450332,
    "recall_micro_best": 0.8838174273858921,
    "f1_micro_best": 0.7845303867403316,
    "precision_weighted_best": 0.7109763128449592,
    "recall_weighted_best": 0.8838174273858921,
    "f1_weighted_best": 0.7867224265402494,
    "accuracy_exact_best": 0.6200873362445415,
    "accuracy_hamming_best": 0.8978165938864628,
    "precision_epidural_best": 0.5384615384615384,
    "recall_epidural_best": 0.6363636363636364,
    "f1_epidural_best": 0.5833333333333334,
    "precision_intraparenchymal_best": 0.7746478873239436,
    "recall_intraparenchymal_best": 0.8870967741935484,
    "f1_intraparenchymal_best": 0.8270676691729323,
    "precision_intraventricular_best": 0.8448275862068966,
    "recall_intraventricular_best": 1.0,
    "f1_intraventricular_best": 0.9158878504672897,
    "precision_subarachnoid_best": 0.6578947368421053,
    "recall_subarachnoid_best": 0.8333333333333334,
    "f1_subarachnoid_best": 0.7352941176470588,
    "precision_subdural_best": 0.6190476190476191,
    "recall_subdural_best": 0.8813559322033898,
    "f1_subdural_best": 0.7272727272727274
  },
  "best_threshold": 0.08,
  "config": {
    "model": {
      "name": "google/vit-base-patch16-224",
      "pretrained": true,
      "num_classes": 5,
      "input_channels": 9,
      "slice_channels": 3,
      "dropout": 0.1,
      "backend": "torchvision",
      "unfreeze_layers": -1,
      "rnn_hidden_size": 512,
      "rnn_num_layers": 1,
      "rnn_dropout": 0.0,
      "sequence_pooling": "last"
    },
    "data": {
      "data_root": "DL_Project_Processed_Data",
      "train_split": "train",
      "val_split": "val",
      "test_split": "test",
      "batch_size": 32,
      "num_workers": 12,
      "pin_memory": true
    },
    "training": {
      "epochs": 50,
      "learning_rate": 0.0001,
      "weight_decay": 1e-05,
      "optimizer": "adamw",
      "scheduler": "cosine",
      "warmup_epochs": 5,
      "gradient_clip": 1.0,
      "early_stopping": {
        "enabled": true,
        "patience": 10,
        "min_delta": 0.0,
        "mode": "max"
      }
    },
    "loss": {
      "type": "weighted_bce",
      "pos_weight_strategy": "inverse_freq"
    },
    "metrics": {
      "track_per_class": true,
      "metrics_list": [
        "auc_roc",
        "precision",
        "recall",
        "f1_score",
        "accuracy"
      ],
      "threshold": 0.5
    },
    "wandb": {
      "project": "Deep Machine Learning Project",
      "entity": null,
      "log_interval": 10,
      "log_model": true,
      "watch_model": true
    },
    "checkpoint": {
      "save_dir": "checkpoints",
      "save_best": true,
      "metric_for_best": "val_auc_roc_macro",
      "mode": "max"
    },
    "ensemble": {
      "enabled": false,
      "full_vit_path": "best_model_full.pt",
      "rnn_vit_path": "best_model_rnn.pt",
      "method": "average",
      "weights": [
        0.5,
        0.5
      ]
    },
    "hardware": {
      "device": "auto",
      "seed": 5252
    }
  }
}